<!DOCTYPE html>
<html lang="zh-CN" class="scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Minecraft Wiki API - 测试控制台</title>
    <!-- Fonts - 使用国内 CDN -->
    <link href="https://fonts.loli.net/css2?family=Inter:wght@300;400;500;600;700&family=JetBrains+Mono:wght@400;500&display=swap" rel="stylesheet">
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    fontFamily: {
                        sans: ['Inter', 'sans-serif'],
                        mono: ['JetBrains Mono', 'monospace'],
                    },
                    colors: {
                        mc: {
                            green: '#4ade80', // Minecraft green-ish
                            dark: '#1e293b',
                        }
                    }
                }
            }
        }
    </script>
    <!-- Icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        /* Custom scrollbar for code blocks */
        .custom-scrollbar::-webkit-scrollbar {
            width: 8px;
            height: 8px;
        }
        .custom-scrollbar::-webkit-scrollbar-track {
            background: #1e293b;
        }
        .custom-scrollbar::-webkit-scrollbar-thumb {
            background: #475569;
            border-radius: 4px;
        }
        .custom-scrollbar::-webkit-scrollbar-thumb:hover {
            background: #64748b;
        }
        
        /* Syntax highlighting classes */
        .json-key { color: #9cdcfe; }
        .json-string { color: #ce9178; }
        .json-number { color: #b5cea8; }
        .json-boolean { color: #569cd6; }
        .json-null { color: #569cd6; }

        .loader {
            border: 3px solid #f3f3f3;
            border-top: 3px solid #10b981;
            border-radius: 50%;
            width: 20px;
            height: 20px;
            animation: spin 1s linear infinite;
        }
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
    </style>
<link rel="stylesheet" href="/index.css">
</head>
<body class="bg-slate-50 text-slate-800 font-sans antialiased selection:bg-emerald-100 selection:text-emerald-900">

    <!-- Header -->
    <header class="sticky top-0 z-50 bg-white/80 backdrop-blur-md border-b border-slate-200 shadow-sm transition-all duration-300">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex justify-between items-center h-16">
                <div class="flex items-center gap-3">
                    <div class="bg-emerald-500 text-white p-2 rounded-lg shadow-sm">
                        <i class="fa-solid fa-cube text-xl"></i>
                    </div>
                    <div>
                        <h1 class="text-xl font-bold text-slate-900 tracking-tight">Minecraft Wiki API</h1>
                        <p class="text-xs text-slate-500 font-medium">开发者测试控制台</p>
                    </div>
                </div>
                <div class="flex items-center gap-4">
                    <span class="hidden md:inline-flex items-center gap-1.5 px-3 py-1 rounded-full text-xs font-medium bg-emerald-50 text-emerald-700 border border-emerald-200">
                        <span class="w-2 h-2 rounded-full bg-emerald-500 animate-pulse"></span>
                        System Ready
                    </span>
                    <a href="https://github.com/rice-awa/minecraft-wiki-fetch-api" target="_blank" class="text-slate-400 hover:text-slate-800 transition-colors">
                        <i class="fa-brands fa-github text-xl"></i>
                    </a>
                </div>
            </div>
        </div>
    </header>

    <main class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8 space-y-12">

        <!-- Quick Links Section -->
        <section>
            <div class="flex items-center gap-2 mb-6">
                <i class="fa-solid fa-bolt text-emerald-500"></i>
                <h2 class="text-lg font-semibold text-slate-900">快速导航</h2>
            </div>
            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-5 gap-4">
                <a href="/health" target="_blank" class="group bg-white p-5 rounded-xl border border-slate-200 shadow-sm hover:shadow-md hover:border-emerald-300 transition-all duration-200">
                    <div class="flex justify-between items-start mb-2">
                        <div class="p-2 bg-blue-50 text-blue-600 rounded-lg group-hover:bg-blue-100 transition-colors">
                            <i class="fa-solid fa-heart-pulse"></i>
                        </div>
                        <i class="fa-solid fa-arrow-up-right-from-square text-slate-300 group-hover:text-emerald-500 text-xs"></i>
                    </div>
                    <h3 class="font-semibold text-slate-900 mb-1">健康检查</h3>
                    <p class="text-sm text-slate-500">查看服务运行状态</p>
                </a>

                <a href="/api" target="_blank" class="group bg-white p-5 rounded-xl border border-slate-200 shadow-sm hover:shadow-md hover:border-emerald-300 transition-all duration-200">
                    <div class="flex justify-between items-start mb-2">
                        <div class="p-2 bg-purple-50 text-purple-600 rounded-lg group-hover:bg-purple-100 transition-colors">
                            <i class="fa-solid fa-book"></i>
                        </div>
                        <i class="fa-solid fa-arrow-up-right-from-square text-slate-300 group-hover:text-emerald-500 text-xs"></i>
                    </div>
                    <h3 class="font-semibold text-slate-900 mb-1">API 文档</h3>
                    <p class="text-sm text-slate-500">查看完整接口定义</p>
                </a>

                <a href="/api/search?q=钻石&pretty=true" target="_blank" class="group bg-white p-5 rounded-xl border border-slate-200 shadow-sm hover:shadow-md hover:border-emerald-300 transition-all duration-200">
                    <div class="flex justify-between items-start mb-2">
                        <div class="p-2 bg-orange-50 text-orange-600 rounded-lg group-hover:bg-orange-100 transition-colors">
                            <i class="fa-solid fa-magnifying-glass"></i>
                        </div>
                        <i class="fa-solid fa-arrow-up-right-from-square text-slate-300 group-hover:text-emerald-500 text-xs"></i>
                    </div>
                    <h3 class="font-semibold text-slate-900 mb-1">GET 搜索示例</h3>
                    <p class="text-sm text-slate-500">直接调用搜索接口</p>
                </a>

                <a href="/api/page/钻石?pretty=true" target="_blank" class="group bg-white p-5 rounded-xl border border-slate-200 shadow-sm hover:shadow-md hover:border-emerald-300 transition-all duration-200">
                    <div class="flex justify-between items-start mb-2">
                        <div class="p-2 bg-teal-50 text-teal-600 rounded-lg group-hover:bg-teal-100 transition-colors">
                            <i class="fa-solid fa-file-code"></i>
                        </div>
                        <i class="fa-solid fa-arrow-up-right-from-square text-slate-300 group-hover:text-emerald-500 text-xs"></i>
                    </div>
                    <h3 class="font-semibold text-slate-900 mb-1">GET 页面示例</h3>
                    <p class="text-sm text-slate-500">获取单页面JSON</p>
                </a>

                <a href="/api/page/工作台?format=wikitext&pretty=true" target="_blank" class="group bg-white p-5 rounded-xl border border-slate-200 shadow-sm hover:shadow-md hover:border-emerald-300 transition-all duration-200">
                    <div class="flex justify-between items-start mb-2">
                        <div class="p-2 bg-indigo-50 text-indigo-600 rounded-lg group-hover:bg-indigo-100 transition-colors">
                            <i class="fa-solid fa-code"></i>
                        </div>
                        <i class="fa-solid fa-arrow-up-right-from-square text-slate-300 group-hover:text-emerald-500 text-xs"></i>
                    </div>
                    <h3 class="font-semibold text-slate-900 mb-1">GET Wikitext</h3>
                    <p class="text-sm text-slate-500">获取页面源代码</p>
                </a>
            </div>
        </section>

        <div class="grid grid-cols-1 lg:grid-cols-12 gap-8">
            <!-- Left Column: Health & Search -->
            <div class="lg:col-span-7 space-y-8">
                
                <!-- Health Check Card -->
                <section class="bg-white rounded-2xl shadow-sm border border-slate-200 overflow-hidden">
                    <div class="px-6 py-4 border-b border-slate-100 flex justify-between items-center bg-slate-50/50">
                        <div class="flex items-center gap-2">
                            <span class="w-1.5 h-4 bg-emerald-500 rounded-full"></span>
                            <h2 class="font-semibold text-slate-800">系统诊断</h2>
                        </div>
                        <span class="text-xs text-slate-400 font-mono">/health/*</span>
                    </div>
                    <div class="p-6">
                        <div class="flex flex-wrap gap-3 mb-6">
                            <button onclick="testHealth('/health')" class="flex-1 min-w-[120px] px-4 py-2.5 bg-emerald-600 hover:bg-emerald-700 text-white text-sm font-medium rounded-lg shadow-sm shadow-emerald-200 transition-all active:scale-95 flex justify-center items-center gap-2">
                                <i class="fa-solid fa-check-circle"></i> 基础检查
                            </button>
                            <button onclick="testHealth('/health/detailed')" class="flex-1 min-w-[120px] px-4 py-2.5 bg-white border border-slate-200 text-slate-700 hover:bg-slate-50 hover:border-emerald-300 hover:text-emerald-700 text-sm font-medium rounded-lg transition-all active:scale-95">
                                详细信息
                            </button>
                            <button onclick="testHealth('/health/live')" class="flex-1 min-w-[120px] px-4 py-2.5 bg-white border border-slate-200 text-slate-700 hover:bg-slate-50 hover:border-emerald-300 hover:text-emerald-700 text-sm font-medium rounded-lg transition-all active:scale-95">
                                存活状态
                            </button>
                        </div>
                        
                        <!-- Console Output -->
                        <div id="health-result" class="hidden group relative">
                            <div class="absolute top-3 right-3 opacity-0 group-hover:opacity-100 transition-opacity">
                                <button onclick="copyResult('health-result')" class="bg-slate-700 hover:bg-slate-600 text-slate-200 text-xs px-2 py-1 rounded border border-slate-600">
                                    <i class="fa-regular fa-copy mr-1"></i>Copy
                                </button>
                            </div>
                            <div class="bg-slate-900 rounded-lg p-4 font-mono text-sm overflow-x-auto custom-scrollbar shadow-inner max-h-64">
                                <pre id="health-content" class="text-slate-300"></pre>
                            </div>
                        </div>
                    </div>
                </section>

                <!-- Search Card -->
                <section class="bg-white rounded-2xl shadow-sm border border-slate-200 overflow-hidden">
                    <div class="px-6 py-4 border-b border-slate-100 flex justify-between items-center bg-slate-50/50">
                        <div class="flex items-center gap-2">
                            <span class="w-1.5 h-4 bg-blue-500 rounded-full"></span>
                            <h2 class="font-semibold text-slate-800">全站搜索</h2>
                        </div>
                        <span class="text-xs text-slate-400 font-mono">/api/search</span>
                    </div>
                    <div class="p-6">
                        <div class="grid grid-cols-1 sm:grid-cols-3 gap-4 mb-5">
                            <div class="sm:col-span-2 space-y-1.5">
                                <label class="text-xs font-semibold text-slate-500 uppercase tracking-wider ml-1">关键词</label>
                                <div class="relative">
                                    <i class="fa-solid fa-search absolute left-3 top-3 text-slate-400"></i>
                                    <input type="text" id="search-keyword" value="钻石" class="w-full pl-10 pr-4 py-2.5 bg-slate-50 border border-slate-200 rounded-lg text-sm text-slate-800 focus:outline-none focus:ring-2 focus:ring-blue-500/20 focus:border-blue-500 transition-all placeholder:text-slate-400" placeholder="例如: 铁锭">
                                </div>
                            </div>
                            <div class="space-y-1.5">
                                <label class="text-xs font-semibold text-slate-500 uppercase tracking-wider ml-1">数量限制</label>
                                <input type="number" id="search-limit" value="5" min="1" max="50" class="w-full px-4 py-2.5 bg-slate-50 border border-slate-200 rounded-lg text-sm text-slate-800 focus:outline-none focus:ring-2 focus:ring-blue-500/20 focus:border-blue-500 transition-all">
                            </div>
                        </div>

                        <div class="flex flex-wrap items-center gap-3 mb-6">
                            <button onclick="testSearch(true)" class="px-5 py-2.5 bg-blue-600 hover:bg-blue-700 text-white text-sm font-medium rounded-lg shadow-sm shadow-blue-200 transition-all active:scale-95">
                                <i class="fa-solid fa-play mr-1.5"></i> 执行搜索
                            </button>
                            <div class="h-6 w-px bg-slate-200 mx-1"></div>
                            <span class="text-xs text-slate-500 font-medium">热门:</span>
                            <button onclick="quickSearch('红石')" class="px-3 py-1.5 bg-red-50 text-red-600 border border-red-100 hover:bg-red-100 hover:border-red-200 rounded-md text-xs font-medium transition-colors">红石</button>
                            <button onclick="quickSearch('末影龙')" class="px-3 py-1.5 bg-purple-50 text-purple-600 border border-purple-100 hover:bg-purple-100 hover:border-purple-200 rounded-md text-xs font-medium transition-colors">末影龙</button>
                        </div>

                        <!-- Console Output -->
                        <div id="search-result" class="hidden group relative">
                            <div class="absolute top-3 right-3 opacity-0 group-hover:opacity-100 transition-opacity z-10">
                                <button onclick="copyResult('search-result')" class="bg-slate-700 hover:bg-slate-600 text-slate-200 text-xs px-2 py-1 rounded border border-slate-600 backdrop-blur">
                                    <i class="fa-regular fa-copy mr-1"></i>Copy
                                </button>
                            </div>
                            <div class="bg-slate-900 rounded-lg p-4 font-mono text-sm overflow-x-auto custom-scrollbar shadow-inner max-h-[400px]">
                                <pre id="search-content" class="text-slate-300"></pre>
                            </div>
                        </div>
                    </div>
                </section>
            </div>

            <!-- Right Column: Page & Batch -->
            <div class="lg:col-span-5 space-y-8">
                
                <!-- Page Content Card -->
                <section class="bg-white rounded-2xl shadow-sm border border-slate-200 overflow-hidden">
                    <div class="px-6 py-4 border-b border-slate-100 flex justify-between items-center bg-slate-50/50">
                        <div class="flex items-center gap-2">
                            <span class="w-1.5 h-4 bg-purple-500 rounded-full"></span>
                            <h2 class="font-semibold text-slate-800">页面获取</h2>
                        </div>
                        <span class="text-xs text-slate-400 font-mono">/api/page/{title}</span>
                    </div>
                    <div class="p-6">
                        <div class="space-y-4 mb-6">
                            <div class="space-y-1.5">
                                <label class="text-xs font-semibold text-slate-500 uppercase tracking-wider ml-1">页面标题</label>
                                <input type="text" id="page-name" value="草方块" class="w-full px-4 py-2.5 bg-slate-50 border border-slate-200 rounded-lg text-sm text-slate-800 focus:outline-none focus:ring-2 focus:ring-purple-500/20 focus:border-purple-500 transition-all placeholder:text-slate-400">
                            </div>
                            <div class="space-y-1.5">
                                <label class="text-xs font-semibold text-slate-500 uppercase tracking-wider ml-1">格式</label>
                                <div class="relative">
                                    <select id="page-format" class="w-full px-4 py-2.5 bg-slate-50 border border-slate-200 rounded-lg text-sm text-slate-800 focus:outline-none focus:ring-2 focus:ring-purple-500/20 focus:border-purple-500 transition-all appearance-none cursor-pointer">
                                        <option value="both">Both (HTML + Markdown)</option>
                                        <option value="html">HTML Only</option>
                                        <option value="markdown">Markdown Only</option>
                                        <option value="wikitext">Wikitext Only</option>
                                    </select>
                                    <i class="fa-solid fa-chevron-down absolute right-4 top-3.5 text-slate-400 pointer-events-none text-xs"></i>
                                </div>
                            </div>
                        </div>

                        <div class="grid grid-cols-2 gap-3 mb-6">
                            <button onclick="testPage(true)" class="col-span-2 px-4 py-2.5 bg-purple-600 hover:bg-purple-700 text-white text-sm font-medium rounded-lg shadow-sm shadow-purple-200 transition-all active:scale-95">
                                获取页面详情
                            </button>
                            <button onclick="testPageExists()" class="px-3 py-2 bg-white border border-slate-200 text-slate-600 hover:border-purple-300 hover:text-purple-700 text-sm font-medium rounded-lg transition-colors">
                                检查存在性
                            </button>
                            <button onclick="quickPage('工作台')" class="px-3 py-2 bg-white border border-slate-200 text-slate-600 hover:border-purple-300 hover:text-purple-700 text-sm font-medium rounded-lg transition-colors">
                                示例: 工作台
                            </button>
                        </div>

                         <!-- Console Output -->
                         <div id="page-result" class="hidden group relative">
                            <div class="absolute top-3 right-3 opacity-0 group-hover:opacity-100 transition-opacity z-10">
                                <button onclick="copyResult('page-result')" class="bg-slate-700 hover:bg-slate-600 text-slate-200 text-xs px-2 py-1 rounded border border-slate-600 backdrop-blur">
                                    <i class="fa-regular fa-copy mr-1"></i>
                                </button>
                            </div>
                            <div class="bg-slate-900 rounded-lg p-4 font-mono text-sm overflow-x-auto custom-scrollbar shadow-inner max-h-64">
                                <pre id="page-content" class="text-slate-300"></pre>
                            </div>
                        </div>
                    </div>
                </section>

                <!-- Batch Ops Card -->
                <section class="bg-white rounded-2xl shadow-sm border border-slate-200 overflow-hidden">
                    <div class="px-6 py-4 border-b border-slate-100 flex justify-between items-center bg-slate-50/50">
                        <div class="flex items-center gap-2">
                            <span class="w-1.5 h-4 bg-orange-500 rounded-full"></span>
                            <h2 class="font-semibold text-slate-800">批量操作</h2>
                        </div>
                        <span class="text-xs text-slate-400 font-mono">POST /api/pages</span>
                    </div>
                    <div class="p-6">
                        <div class="space-y-1.5 mb-4">
                            <div class="flex justify-between items-center">
                                <label class="text-xs font-semibold text-slate-500 uppercase tracking-wider ml-1">页面列表 (每行一个)</label>
                                <div class="space-x-1">
                                    <button onclick="loadPreset('tools')" class="text-[10px] px-2 py-0.5 bg-slate-100 text-slate-600 rounded hover:bg-slate-200">工具</button>
                                    <button onclick="loadPreset('blocks')" class="text-[10px] px-2 py-0.5 bg-slate-100 text-slate-600 rounded hover:bg-slate-200">方块</button>
                                </div>
                            </div>
                            <textarea id="batch-pages" rows="4" class="w-full px-4 py-3 bg-slate-50 border border-slate-200 rounded-lg text-sm text-slate-800 font-mono focus:outline-none focus:ring-2 focus:ring-orange-500/20 focus:border-orange-500 transition-all resize-none custom-scrollbar" placeholder="钻石&#10;铁锭">钻石
铁锭
金锭</textarea>
                        </div>
                        
                        <div class="flex gap-4 mb-5">
                            <div class="flex-1 space-y-1.5">
                                <label class="text-xs font-semibold text-slate-500 uppercase tracking-wider ml-1">格式</label>
                                <div class="relative">
                                    <select id="batch-format" class="w-full px-3 py-2 bg-slate-50 border border-slate-200 rounded-lg text-sm text-slate-800 focus:outline-none focus:ring-2 focus:ring-orange-500/20 focus:border-orange-500 appearance-none">
                                        <option value="markdown">Markdown</option>
                                        <option value="html">HTML</option>
                                        <option value="wikitext">Wikitext</option>
                                    </select>
                                    <i class="fa-solid fa-chevron-down absolute right-3 top-3 text-slate-400 pointer-events-none text-[10px]"></i>
                                </div>
                            </div>
                            <div class="w-24 space-y-1.5">
                                <label class="text-xs font-semibold text-slate-500 uppercase tracking-wider ml-1">并发数</label>
                                <input type="number" id="batch-concurrency" value="3" max="5" class="w-full px-3 py-2 bg-slate-50 border border-slate-200 rounded-lg text-sm text-slate-800 focus:outline-none focus:ring-2 focus:ring-orange-500/20 focus:border-orange-500">
                            </div>
                        </div>

                        <button onclick="testBatchPages()" class="w-full px-4 py-2.5 bg-orange-500 hover:bg-orange-600 text-white text-sm font-medium rounded-lg shadow-sm shadow-orange-200 transition-all active:scale-95">
                            开始批量获取
                        </button>

                         <!-- Console Output -->
                         <div id="batch-result" class="hidden group relative mt-6">
                            <div class="absolute top-3 right-3 opacity-0 group-hover:opacity-100 transition-opacity z-10">
                                <button onclick="copyResult('batch-result')" class="bg-slate-700 hover:bg-slate-600 text-slate-200 text-xs px-2 py-1 rounded border border-slate-600 backdrop-blur">
                                    <i class="fa-regular fa-copy mr-1"></i>
                                </button>
                            </div>
                            <div class="bg-slate-900 rounded-lg p-4 font-mono text-sm overflow-x-auto custom-scrollbar shadow-inner max-h-64">
                                <pre id="batch-content" class="text-slate-300"></pre>
                            </div>
                        </div>
                    </div>
                </section>
            </div>
        </div>

    </main>
    
    <footer class="bg-white border-t border-slate-200 mt-12 py-8">
        <div class="max-w-7xl mx-auto px-4 text-center">
            <p class="text-slate-500 text-sm">© 2026 Minecraft Wiki API Console. Not affiliated with Mojang Studios.</p>
        </div>
    </footer>

    <!-- Toast Notification Container -->
    <div id="toast-container" class="fixed bottom-4 right-4 z-50 flex flex-col gap-2 pointer-events-none"></div>

    <script>
        const API_BASE = window.location.origin;

        /**
         * Simple syntax highlighting for JSON
         */
        function syntaxHighlight(json) {
            if (typeof json !== 'string') {
                json = JSON.stringify(json, null, 2);
            }
            json = json.replace(/&/g, '&amp;').replace(/</g, '&lt;').replace(/>/g, '&gt;');
            return json.replace(/("(\\u[a-zA-Z0-9]{4}|\\[^u]|[^\\"])*"(\s*:)?|\b(true|false|null)\b|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?)/g, function (match) {
                var cls = 'json-number';
                if (/^"/.test(match)) {
                    if (/:$/.test(match)) {
                        cls = 'json-key';
                    } else {
                        cls = 'json-string';
                    }
                } else if (/true|false/.test(match)) {
                    cls = 'json-boolean';
                } else if (/null/.test(match)) {
                    cls = 'json-null';
                }
                return '<span class="' + cls + '">' + match + '</span>';
            });
        }

        function showToast(message, type = 'success') {
            const container = document.getElementById('toast-container');
            const toast = document.createElement('div');
            
            // Colors
            const bgClass = type === 'success' ? 'bg-slate-800' : 'bg-red-600';
            
            toast.className = `${bgClass} text-white px-4 py-3 rounded-lg shadow-lg transform transition-all duration-300 translate-y-10 opacity-0 flex items-center gap-3 min-w-[200px]`;
            toast.innerHTML = `
                <i class="fa-solid ${type === 'success' ? 'fa-circle-check' : 'fa-circle-exclamation'} text-${type === 'success' ? 'emerald-400' : 'white'}"></i>
                <span class="text-sm font-medium">${message}</span>
            `;
            
            container.appendChild(toast);
            
            // Animate in
            requestAnimationFrame(() => {
                toast.classList.remove('translate-y-10', 'opacity-0');
            });

            // Remove
            setTimeout(() => {
                toast.classList.add('translate-y-10', 'opacity-0');
                setTimeout(() => toast.remove(), 300);
            }, 3000);
        }

        async function makeRequest(url, options = {}) {
            const resultElement = options.resultElement;
            const contentElement = options.contentElement;

            if (resultElement) {
                resultElement.classList.remove('hidden');
                // Scroll to result on mobile only
                if(window.innerWidth < 768) {
                    resultElement.scrollIntoView({ behavior: 'smooth', block: 'nearest' });
                }
            }
            
            if (contentElement) {
                contentElement.innerHTML = '<div class="flex items-center gap-3 text-slate-400 py-4"><div class="loader"></div><span>正在请求 API...</span></div>';
            }

            try {
                const response = await fetch(url, options);
                const data = await response.json();
                
                if (contentElement) {
                    contentElement.innerHTML = syntaxHighlight(data);
                }
                
                if(response.ok) {
                   showToast(`请求成功 (${response.status})`);
                } else {
                   showToast(`请求返回错误 (${response.status})`, 'error');
                }
                
                return { success: true, data, status: response.status };
            } catch (error) {
                if (contentElement) {
                    contentElement.innerHTML = `<span class="text-red-400">Error: ${error.message}</span>`;
                }
                showToast('网络请求失败', 'error');
                return { success: false, error: error.message };
            }
        }

        // Functions from original logic, mapped to new UI
        async function testHealth(endpoint) {
            await makeRequest(`${API_BASE}${endpoint}`, {
                resultElement: document.getElementById('health-result'),
                contentElement: document.getElementById('health-content')
            });
        }

        async function testSearch(pretty = false) {
            const keyword = document.getElementById('search-keyword').value;
            const limit = document.getElementById('search-limit').value;
            
            if (!keyword.trim()) {
                showToast('请输入关键词', 'error');
                document.getElementById('search-keyword').focus();
                return;
            }

            const params = new URLSearchParams({ q: keyword, limit: limit });
            if (pretty) params.append('pretty', 'true');
            
            await makeRequest(`${API_BASE}/api/search?${params}`, {
                resultElement: document.getElementById('search-result'),
                contentElement: document.getElementById('search-content')
            });
        }

        async function quickSearch(keyword) {
            document.getElementById('search-keyword').value = keyword;
            await testSearch(true);
        }

        async function testPage(pretty = false) {
            const pageName = document.getElementById('page-name').value;
            const format = document.getElementById('page-format').value;
            
            if (!pageName.trim()) {
                showToast('请输入页面名称', 'error');
                return;
            }

            const params = new URLSearchParams({ format });
            if (pretty) params.append('pretty', 'true');
            
            await makeRequest(`${API_BASE}/api/page/${encodeURIComponent(pageName)}?${params}`, {
                resultElement: document.getElementById('page-result'),
                contentElement: document.getElementById('page-content')
            });
        }

        async function quickPage(pageName) {
            document.getElementById('page-name').value = pageName;
            await testPage(true);
        }

        async function testPageExists() {
            const pageName = document.getElementById('page-name').value;
            if (!pageName.trim()) {
                showToast('请输入页面名称', 'error');
                return;
            }
            await makeRequest(`${API_BASE}/api/page/${encodeURIComponent(pageName)}/exists`, {
                resultElement: document.getElementById('page-result'),
                contentElement: document.getElementById('page-content')
            });
        }

        async function testBatchPages() {
            const pagesText = document.getElementById('batch-pages').value;
            const format = document.getElementById('batch-format').value;
            const concurrency = parseInt(document.getElementById('batch-concurrency').value);
            
            const pages = pagesText.split('\n').map(p => p.trim()).filter(p => p);
            
            if (pages.length === 0) {
                showToast('列表不能为空', 'error');
                return;
            }

            await makeRequest(`${API_BASE}/api/pages`, {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({ pages, format, concurrency }),
                resultElement: document.getElementById('batch-result'),
                contentElement: document.getElementById('batch-content')
            });
        }

        function loadPreset(type) {
            const presets = {
                tools: ['钻石剑', '钻石镐', '钻石斧', '钻石锹'],
                blocks: ['钻石块', '铁块', '金块', '红石块']
            };
            if (presets[type]) {
                document.getElementById('batch-pages').value = presets[type].join('\n');
                showToast(`已加载预设: ${type}`);
            }
        }

        function copyResult(containerId) {
            const container = document.getElementById(containerId);
            // Get text content (strip html tags for clean copy)
            const content = container.querySelector('pre').textContent;
            
            navigator.clipboard.writeText(content).then(() => {
                showToast('内容已复制到剪贴板');
            }).catch(() => {
                showToast('复制失败', 'error');
            });
        }

        // Auto-run health check on load for visual feedback
        document.addEventListener('DOMContentLoaded', () => {
            testHealth('/health');
        });
    </script>
<script type="module" src="/index.tsx"></script>
</body>
</html>